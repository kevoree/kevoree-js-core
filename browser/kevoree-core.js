!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("KevoreeLibrary")):"function"==typeof define&&define.amd?define(["KevoreeLibrary"],t):"object"==typeof exports?exports.KevoreeCore=t(require("KevoreeLibrary")):e.KevoreeCore=t(e.KevoreeLibrary)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t,n){if(!e||!t||!n)throw new Error("KevoreeCore constructor needs a KevScript engine, modulesPath and a KevoreeLogger");this.log=n,this.kevs=e,this.stopping=!1,this.currentModel=null,this.deployModel=null,this.nodeName=null,this.nodeInstance=null,this.modulesPath=t,this.bootstrapper=null,this.firstBoot=!0,this.scriptQueue=[],this.emitter=new u}var o=n(1),i=n(2),s=n(28),u=n(32).EventEmitter,a=/^[\w]+$/;s.inherits(r,u),r.prototype.start=function(e){if(e&&0!==e.length||(e="node0"),!e.match(a))throw new Error("Platform node name must match this regex "+a.toString());this.nodeName=e;var t=new o.factory.DefaultKevoreeFactory;this.currentModel=t.createContainerRoot(),t.root(this.currentModel);var n=t.createContainerNode();n.name=this.nodeName,n.started=!1,this.currentModel.addNodes(n);var r=setInterval(function(){},1e11);this.emitter.on("stopped",function(){clearInterval(r),this.emit("stopped")}.bind(this)),this.log.info(this.toString(),"Platform node name: "+e)},r.prototype.stop=function(){var e=new o.factory.DefaultKevoreeFactory,t=e.createModelCloner(),n=t.clone(this.currentModel,!1),r=n.findNodesByID(this.nodeName);r.started=!1;for(var i=r.hosts.iterator();i.hasNext();)i.next()["delete"]();for(var s=r.groups.iterator();s.hasNext();)s.next()["delete"]();for(var u=n.mBindings.iterator();u.hasNext();){var a=u.next();a.port.eContainer()&&a.port.eContainer().eContainer()&&a.port.eContainer().eContainer().name===r.name&&a.hub&&a.hub["delete"]()}for(var l=r.components.iterator();l.hasNext();)l.next()["delete"]();this.stopping=!0,this.deploy(n,function(){null===this.nodeInstance?(this.log.info(this.toString(),"Platform stopped before bootstrapped"),this.emitter.emit("stopped")):(this.log.info(this.toString(),"Platform stopped: "+this.nodeInstance.getName()),this.emitter.emit("stopped"))}.bind(this))},r.prototype.deploy=function(e,t){if(t=t||function(){},this.deployModel)this.log.warn(this.toString(),"New deploy process requested: aborted because another one is in process (retry later?)"),t(new Error("New deploy process requested: aborted because another one is in process (retry later?)"));else if(this.emit("deploying",e),e&&!e.findNodesByID(this.nodeName))t(new Error("Deploy model failure: unable to find "+this.nodeName+" in given model"));else{this.log.debug(this.toString(),"Deploy process started...");var n=(new Date).getTime();if(e){var r=this;this.checkBootstrapNode(e,function(s){if(s)r.emit("error",s),t(s);else if(r.nodeInstance)try{var u=new o.factory.DefaultKevoreeFactory,a=u.createModelCloner();r.deployModel=a.clone(e,!0),r.deployModel.setRecursiveReadOnly();var l=u.createModelCompare().diff(r.currentModel,r.deployModel),c=r.nodeInstance.processTraces(l,r.deployModel),f=[],p=function(e,t){f.unshift(e);var n,o=!1;try{e.execute(function(i){n||(i&&r.stopping&&(r.log.error(e.toString(),"Fail adaptation skipped: "+i.message),i=null),t(i),o=!0)})}catch(i){o?r.log.error(r.toString(),"The execution of "+e.toString()+" threw an exception\n"+i.stack):(n=i,t(i))}},d=function(e,t){try{e.undo(t)}catch(n){t(n)}};i(c,p,function(o){o?(o.message="Something went wrong while processing adaptations.\n"+o.message,r.log.error(r.toString(),o.stack),r.firstBoot?(r.log.warn(r.toString(),"Shutting down Kevoree because first deployment failed..."),r.deployModel=null,r.stop(),t(o)):(r.log.info(r.toString(),"Rollbacking to previous model..."),i(f,d,function(e){e?(e.message="Something went wrong while rollbacking. Process will exit.\n"+e.message,r.log.error(r.toString(),e.stack),r.deployModel=null,r.stop(),t(e)):(r.log.info(r.toString(),"Rollback succeed: "+f.length+" adaptations ("+((new Date).getTime()-n)+"ms)"),r.deployModel=null,r.emit("rollbackSucceed"),t())}))):(r.currentModel=e,r.deployModel=null,r.log.info(r.toString(),"Model deployed successfully: "+c.length+" adaptations ("+((new Date).getTime()-n)+"ms)"),r.processScriptQueue(),r.emit("deployed"),r.firstBoot=!1,t())})}catch(h){r.log.error(r.toString(),"Deployment failed.\n"+h.stack),r.deployModel=null,t(h)}else t(new Error("There is no instance to bootstrap on"))})}else t(new Error("Model is not defined or null. Deploy aborted."))}},r.prototype.submitScript=function(e,t){"function"!=typeof t&&(t=function(e){e&&this.log.error(this.toString(),e.message)}.bind(this)),null===this.deployModel?this.kevs.parse(e,this.currentModel,function(e,n){if(e){var r=new Error("KevScript submission failed ("+e.message+")");return void t(r)}var o,i,s;o=function(){this.off("error",i),this.off("adaptationError",s),t()}.bind(this),i=function(e){this.off("deployed",o),this.off("adaptationError",s);var n=new Error("KevScript submission failed ("+e.message+")");t(n)}.bind(this),s=function(e){this.off("error",i),this.off("deployed",o);var n=new Error("KevScript submission failed ("+e.message+")");t(n)}.bind(this),this.once("deployed",o),this.once("error",i),this.once("adaptationError",s),this.deploy(n)}.bind(this)):(this.scriptQueue.push({script:e,callback:t}),this.log.debug(this.toString(),"Script added to queue at position "+this.scriptQueue.length-1))},r.prototype.processScriptQueue=function(){if(this.scriptQueue.length>0){var e=this.scriptQueue[0];this.scriptQueue.splice(0,1),this.log.debug(this.toString(),"Core.processScriptQueue parsing "+e.script),this.kevs.parse(e.script,this.currentModel,function(t,n){if(t){var r=new Error("KevScript submission failed ("+t.message+")");e.callback(r)}else{var o,i,s;o=function(){this.off("error",i),this.off("adaptationError",s),e.callback()}.bind(this),i=function(t){this.off("deployed",o),this.off("adaptationError",s);var n=new Error("KevScript submission failed ("+t.message+")");e.callback(n)}.bind(this),s=function(t){this.off("error",i),this.off("deployed",o);var n=new Error("KevScript submission failed ("+t.message+")");e.callback(n)}.bind(this),this.once("deployed",o),this.once("error",i),this.once("adaptationError",s),this.deploy(n)}}.bind(this))}},r.prototype.checkBootstrapNode=function(e,t){if(t=t||function(){console.warn("No callback defined for checkBootstrapNode(model, cb) in KevoreeCore")},"undefined"==typeof this.nodeInstance||null===this.nodeInstance){this.log.debug(this.toString(),"Start '"+this.nodeName+"' bootstrapping...");try{this.bootstrapper.bootstrapNodeType(this.nodeName,e,function(n,r){if(n)return void t(n);var i=e.findNodesByID(this.nodeName),s=this.currentModel.findNodesByID(this.nodeName);this.nodeInstance=new r(this,i,this.nodeName);var u=new o.factory.DefaultKevoreeFactory;s.dictionary=u.createDictionary().withGenerated_KMF_ID("0"),i.typeDefinition.dictionaryType&&i.typeDefinition.dictionaryType.attributes.array.forEach(function(e){if(!e.fragmentDependant){var t=u.createValue();t.name=e.name,t.value=e.defaultValue,s.dictionary.addValues(t),this.log.debug(this.toString(),"Set default node param: "+t.name+"="+t.value)}}.bind(this)),t()}.bind(this))}catch(n){t(n)}}else t()},r.prototype.toString=function(){return"Core"},r.prototype.getBootstrapper=function(){return this.bootstrapper},r.prototype.setBootstrapper=function(e){this.bootstrapper=e},r.prototype.getModulesPath=function(){return this.modulesPath},r.prototype.getCurrentModel=function(){return this.currentModel},r.prototype.getLastModel=function(){return"undefined"!=typeof this.deployModel&&null!==this.deployModel?this.deployModel:this.currentModel},r.prototype.getDeployModel=function(){return this.deployModel},r.prototype.getNodeName=function(){return this.nodeName},r.prototype.getLogger=function(){return this.log},r.prototype.off=function(e,t){this.removeListener(e,t)},e.exports=r},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),s=n(27),u=r(s);t["default"]=(0,u["default"])(i["default"],1),e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,r){(0,s["default"])(t)(e,(0,a["default"])(n),r)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(4),s=r(i),u=n(26),a=r(u);e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(t,n,r){function o(e){if(f-=1,e)l=!0,r(e);else{if(l&&f<=0)return r(null);i()}}function i(){for(;f<e&&!l;){var t=u();if(null===t)return l=!0,void(f<=0&&r(null));f+=1,n(t.value,t.key,(0,p["default"])(o))}}if(r=(0,a["default"])(r||s["default"]),e<=0||!t)return r(null);var u=(0,c["default"])(t),l=!1,f=0;i()}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(5),s=r(i),u=n(6),a=r(u),l=n(7),c=r(l),f=n(25),p=r(f);e.exports=t["default"]},function(e,t){function n(){}e.exports=n},function(e,t){"use strict";function n(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}function i(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}function s(e){var t=(0,d["default"])(e),n=-1,r=t.length;return function(){var o=t[++n];return n<r?{value:e[o],key:o}:null}}function u(e){if((0,l["default"])(e))return o(e);var t=(0,f["default"])(e);return t?i(t):s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=u;var a=n(8),l=r(a),c=n(12),f=r(c),p=n(13),d=r(p);e.exports=t["default"]},function(e,t,n){function r(e){return null!=e&&i(e.length)&&!o(e)}var o=n(9),i=n(11);e.exports=r},function(e,t,n){function r(e){var t=o(e)?a.call(e):"";return t==i||t==s}var o=n(10),i="[object Function]",s="[object GeneratorFunction]",u=Object.prototype,a=u.toString;e.exports=r},function(e,t){function n(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=n},function(e,t){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}var r=9007199254740991;e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){return n&&e[n]&&e[n]()};var n="function"==typeof Symbol&&Symbol.iterator;e.exports=t["default"]},function(e,t,n){function r(e){return s(e)?o(e):i(e)}var o=n(14),i=n(21),s=n(8);e.exports=r},function(e,t,n){function r(e,t){var n=s(e)||i(e)?o(e.length,String):[],r=n.length,a=!!r;for(var c in e)!t&&!l.call(e,c)||a&&("length"==c||u(c,r))||n.push(c);return n}var o=n(15),i=n(16),s=n(19),u=n(20),a=Object.prototype,l=a.hasOwnProperty;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=n},function(e,t,n){function r(e){return o(e)&&u.call(e,"callee")&&(!l.call(e,"callee")||a.call(e)==i)}var o=n(17),i="[object Arguments]",s=Object.prototype,u=s.hasOwnProperty,a=s.toString,l=s.propertyIsEnumerable;e.exports=r},function(e,t,n){function r(e){return i(e)&&o(e)}var o=n(8),i=n(18);e.exports=r},function(e,t){function n(e){return!!e&&"object"==typeof e}e.exports=n},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){function n(e,t){return t=null==t?r:t,!!t&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=n},function(e,t,n){function r(e){if(!o(e))return i(e);var t=[];for(var n in Object(e))u.call(e,n)&&"constructor"!=n&&t.push(n);return t}var o=n(22),i=n(23),s=Object.prototype,u=s.hasOwnProperty;e.exports=r},function(e,t){function n(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||r;return e===n}var r=Object.prototype;e.exports=n},function(e,t,n){var r=n(24),o=r(Object.keys,Object);e.exports=o},function(e,t){function n(e,t){return function(n){return e(t(n))}}e.exports=n},function(e,t){"use strict";function n(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]},function(e,t){"use strict";function n(e){return function(t,n,r){return e(t,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){return function(n,r,o){return e(n,t,r,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]},function(e,t,n){(function(e,r){function o(e,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&t._extend(r,n),_(r.showHidden)&&(r.showHidden=!1),_(r.depth)&&(r.depth=2),_(r.colors)&&(r.colors=!1),_(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),a(r,e,r.depth)}function i(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function s(e,t){return e}function u(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function a(e,n,r){if(e.customInspect&&n&&j(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return b(o)||(o=a(e,o,r)),o}var i=l(e,n);if(i)return i;var s=Object.keys(n),y=u(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),E(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(n);if(0===s.length){if(j(n)){var v=n.name?": "+n.name:"";return e.stylize("[Function"+v+"]","special")}if(x(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(M(n))return e.stylize(Date.prototype.toString.call(n),"date");if(E(n))return c(n)}var g="",m=!1,w=["{","}"];if(h(n)&&(m=!0,w=["[","]"]),j(n)){var _=n.name?": "+n.name:"";g=" [Function"+_+"]"}if(x(n)&&(g=" "+RegExp.prototype.toString.call(n)),M(n)&&(g=" "+Date.prototype.toUTCString.call(n)),E(n)&&(g=" "+c(n)),0===s.length&&(!m||0==n.length))return w[0]+g+w[1];if(r<0)return x(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var S;return S=m?f(e,n,r,y,s):s.map(function(t){return p(e,n,r,y,t,m)}),e.seen.pop(),d(S,g,w)}function l(e,t){if(_(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return m(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,o){for(var i=[],s=0,u=t.length;s<u;++s)D(t,String(s))?i.push(p(e,t,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(e,t,n,r,o,!0))}),i}function p(e,t,n,r,o,i){var s,u,l;if(l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},l.get?u=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(u=e.stylize("[Setter]","special")),D(r,o)||(s="["+o+"]"),u||(e.seen.indexOf(l.value)<0?(u=v(n)?a(e,l.value,null):a(e,l.value,n-1),u.indexOf("\n")>-1&&(u=i?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),_(s)){if(i&&o.match(/^\d+$/))return u;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function d(e,t,n){var r=0,o=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return null==e}function m(e){return"number"==typeof e}function b(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function _(e){return void 0===e}function x(e){return S(e)&&"[object RegExp]"===N(e)}function S(e){return"object"==typeof e&&null!==e}function M(e){return S(e)&&"[object Date]"===N(e)}function E(e){return S(e)&&("[object Error]"===N(e)||e instanceof Error)}function j(e){return"function"==typeof e}function O(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function N(e){return Object.prototype.toString.call(e)}function L(e){return e<10?"0"+e.toString(10):e.toString(10)}function k(){var e=new Date,t=[L(e.getHours()),L(e.getMinutes()),L(e.getSeconds())].join(":");return[e.getDate(),K[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var T=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,i=r.length,s=String(e).replace(T,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),u=r[n];n<i;u=r[++n])s+=v(u)||!S(u)?" "+u:" "+o(u);return s},t.deprecate=function(n,o){function i(){if(!s){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),s=!0}return n.apply(this,arguments)}if(_(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(r.noDeprecation===!0)return n;var s=!1;return i};var C,P={};t.debuglog=function(e){if(_(C)&&(C=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!P[e])if(new RegExp("\\b"+e+"\\b","i").test(C)){var n=r.pid;P[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else P[e]=function(){};return P[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=y,t.isNull=v,t.isNullOrUndefined=g,t.isNumber=m,t.isString=b,t.isSymbol=w,t.isUndefined=_,t.isRegExp=x,t.isObject=S,t.isDate=M,t.isError=E,t.isFunction=j,t.isPrimitive=O,t.isBuffer=n(30);var K=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",k(),t.format.apply(t,arguments))},t.inherits=n(31),t._extend=function(e,t){if(!t||!S(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this}(),n(29))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){y&&d&&(y=!1,d.length?h=d.concat(h):v=-1,h.length&&u())}function u(){if(!y){var e=o(s);y=!0;for(var t=h.length;t;){for(d=h,h=[];++v<t;)d&&d[v].run();v=-1,t=h.length}d=null,y=!1,i(e)}}function a(e,t){this.fun=e,this.array=t}function l(){}var c,f,p=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,h=[],y=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new a(e,t)),1!==h.length||y||o(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,u,a,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),n.apply(this,u)}else if(i(n))for(u=Array.prototype.slice.call(arguments,1),l=n.slice(),o=l.length,a=0;a<o;a++)l[a].apply(this,u);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,s,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(u=s;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){o=u;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}}])});